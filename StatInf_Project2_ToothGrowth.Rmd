---
title: "StatInf_Assignment2_ToothGrowth"
author: "Willianto Asalim"
date: "17/05/2020"
output: html_document
---

The platform specification used:

Spec    | Description
------- | -----------------------
OS      | Windows 10 Pro - 64 bit
CPU     | AMD Ryzen 5 - 3400G
RAM     | 16GB DDR4 3000MHz
Storage | 500GB SSD - M.2 NVMe (PCIe) 
Tool    | RStudio

***



##  Statistical Inference Proj 2: Basic Inferential Data Analysis

<br />


### The Effect Of Vitamin C On Tooth Growth In Guinea Pigs

<br />


### Sypnosis

The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).

Info on ToothGrowth dataset can be found at the following link: [rdocumentation website](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/ToothGrowth)


***



```{r setoptions, echo=FALSE}
## Setting Global Option where echo = true so that someone will be able to read the code and results.
library(knitr) ##Load Knitr package
library(pander) ##Load package for tidy T test result
knitr::opts_chunk$set(echo = TRUE, results = "asis", tidy = FALSE)
```

#### 1. Load the ToothGrowth data and perform some basic exploratory data analyses

```{r LoadToothGrowth_EDA}
library(datasets) ##Load R Builtin Data sets
data("ToothGrowth") ##Load ToothGrowth Datasets
```

```{r CheckToothGrowthData}
dim(ToothGrowth) ##No. observations and variables
names(ToothGrowth) ##Variables names
kable(head(ToothGrowth))

```

<br />

##### The ToothGrowth Dataset contains `r nrow(ToothGrowth)` observations and `r length(ToothGrowth)` variables: `r names(ToothGrowth)`.

<br />

Below is the Exploratory Data Analysis perform for the dataset using Geom Point.
```{r, ToothGrowthScatterPlot}
library(ggplot2) ##Plotting and data

edaPlot <- ggplot(ToothGrowth, aes(factor(dose), len, color = supp))  ##ggplot basic info
edaPlot + geom_point(size = 2) + theme_bw() + labs(x = "Dose", y = "Length", color = "Supplement") +
        scale_color_brewer(palette = "Dark2")


```

***

#### 2. Provide a basic summary of the data.

```{r ToothGrowthSummary}
summary(ToothGrowth)

```

```{r BoxPlot}
library(gridExtra) ##Provide side by side plotting

##Side by side boxplot on Orange Juice vs Vit C dosage
## edaplot is from the part 1 above.
p1 <- edaPlot + geom_boxplot() +
      # facet_grid(.~supp)+
      facet_grid(.~supp, labeller = as_labeller(
            c("OJ" = "Orange juice", 
              "VC" = "Vitamin C"))) +
      labs(title = "Tooth growth - dosages~supplements",
           x = "Dose in milligrams/day", 
           y = "Tooth Lengh") +
      scale_fill_discrete(name = "Dosage of\nvitamin C\nin mg/day")

## Boxplot based on supplements
p2 <- ggplot(ToothGrowth, aes(supp, len, fill=supp)) +
    geom_boxplot() + theme_bw() + 
    labs( title = "Tooth growth - supplements",
          x = "Supplement", 
          y = "Tooth Length", 
          color = "Supplement") + 
    scale_fill_brewer(palette = "Dark2")

## Side by side plotting
grid.arrange(p2, p1, ncol=2)
```

***

#### 3. Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. 

Based on the explotary data analysis and the summary of the ToothGrowth data performed above we know that there are a total of 60 guinea pigs: 30 are fed with OJ with different dosages and another 30 are fed with VC with different dosages.

The hypothesis tests will be performed using th P value approach, if there is a significance difference with different dosage and supplement type. 95% confidence interval the data is significant difference If the P value is smaller than 0.05 then it is unlikely and if the P value is larger than 0.05 then it is likely that the different supplement and dose has impact on the tooth growth of the guinea pigs. 

There are different tests we can carry out in the ToothGrowth dataset and in this instance we will be conducting 7 tests.
- Test based on different supplements ie OJ vs VC  
- Test based on different dosages in the same supplement. ie half dose vs one dose vs two dose in OJ supplement vice versa.

Create two seperate datas based on two different supplements OJ & VC
```{r oj_vcData}
## Dataset based on OJ Supplement
ojData <- subset(ToothGrowth, supp %in% c("OJ"))
kable(ojData)

## Dataset based on VC Supplement
vcData <- subset(ToothGrowth, supp %in% c("VC"))
kable(vcData)

```

<br />

T Test based on supplement type

```{r TestSupplement}
## T Test on different supplements OJ vs VC
test1 <- t.test(len~supp, data = ToothGrowth, paired = FALSE, var.equal = TRUE)
pander(test1)
```

<br />

T Test based on OJ data dose

```{r OJTestDose}
##Comparing tooth growth base on dose 0.5 vs 1
ojTest0.5_1 <- t.test(len~dose, data = subset(ojData, dose %in% c(.5, 1)), paired = TRUE, var.equal = TRUE)
pander(ojTest0.5_1)


##Comparing tooth growth base on dose 0.5 vs 2
ojTest0.5_2 <- t.test(len~dose, data = subset(ojData, dose %in% c(.5, 2)), paired = TRUE, var.equal = TRUE)
pander(ojTest0.5_2)


##Comparing tooth growth base on dose 1 vs 2
ojTest1_2 <- t.test(len~dose, data = subset(ojData, dose %in% c(.5, 2)), paired = TRUE, var.equal = TRUE)
pander(ojTest1_2)
```

<br />

T Test based on OJ data dose  
```{r VCTestDoseHalfVsOne}
##Comparing tooth growth base on dose 0.5 vs 1
vcTest0.5_1 <- t.test(len~dose, data = subset(vcData, dose %in% c(.5, 1)), paired = TRUE, var.equal = TRUE)
pander(vcTest0.5_1)

```

```{r DoseData}
## Dataset based on 0.5 dose
lowDose <- subset(ToothGrowth, dose %in% c("0.5"))
kable(lowDose)

## Dataset based on 1.0 dose
midDose <- subset(ToothGrowth, dose %in% c("1"))
kable(midDose)

## Dataset based on 2.0 dose
highDose <- subset(ToothGrowth, dose %in% c("2"))
kable(highDose)
```
T Test based on dose

```{r OJTestDose}
##Comparing 0.5 dose tooth growth based supplements 
lowDoseTest <- t.test(len~supp, data = subset(lowDose, supp %in% c("OJ", "VC")), paired = FALSE, var.equal = TRUE)
pander(lowDoseTest)


##Comparing 1.0 dose tooth growth based supplements
midDoseTest <- t.test(len~supp, data = subset(midDose, supp %in% c("OJ", "VC")), paired = FALSE, var.equal = TRUE)
pander(midDoseTest)


##Comparing 2.0 dose tooth growth based supplements
highDoseTest <- t.test(len~supp, data = subset(highDose, supp %in% c("OJ", "VC")), paired = FALSE, var.equal = TRUE)
pander(highDoseTest)
```

***



#### 4. State your conclusions and the assumptions needed for your conclusions.


