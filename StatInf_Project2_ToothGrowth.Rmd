---
title: "StatInf_Assignment2_ToothGrowth"
author: "Willianto Asalim"
date: "17/05/2020"
output: html_document
---

The platform specification used:

Spec    | Description
------- | -----------------------
OS      | Windows 10 Pro - 64 bit
CPU     | AMD Ryzen 5 - 3400G
RAM     | 16GB DDR4 3000MHz
Storage | 500GB SSD - M.2 NVMe (PCIe) 
Tool    | RStudio

***



##  Statistical Inference Proj 2: Basic Inferential Data Analysis

<br />


### The Effect Of Vitamin C On Tooth Growth In Guinea Pigs

<br />


### Sypnosis

The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).

Info on ToothGrowth dataset can be found at the following link: [rdocumentation website](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/ToothGrowth)


***

```{r setoptions, echo=FALSE}
## Setting Global Option where echo = true so that someone will be able to read the code and results.
knitr::opts_chunk$set(echo = TRUE, results = "asis", tidy = FALSE)
```

#### 1. Load the ToothGrowth data and perform some basic exploratory data analyses

```{r LoadToothGrowth_EDA}
library(datasets) ##Load R Builtin Data sets
data("ToothGrowth") ##Load ToothGrowth Datasets
```

```{r CheckToothGrowthData}
dim(ToothGrowth) ##No. observations and variables
names(ToothGrowth) ##variables names
str(ToothGrowth)

```

<br />

##### The ToothGrowth Dataset contains `r nrow(ToothGrowth)` observations and `r length(ToothGrowth)` variables: `r names(ToothGrowth)`.

<br />

Below is the Exploratory Data Analysis perform for the dataset using Geom Point.
```{r, ToothGrowthScatterPlot}
library(ggplot2) ##Load ggplot2 library

edaPlot <- ggplot(ToothGrowth, aes(factor(dose), len, color = supp))  ##ggplot basic info
edaPlot + geom_point(size = 2) + theme_bw() + labs(x = "Dose", y = "Length", color = "Supplement") +
        scale_color_brewer(palette = "Dark2")


```

***

#### 2. Provide a basic summary of the data.

```{r ToothGrowthSummary}
summary(ToothGrowth)

```

```{r BoxPlot}
edaPlot + geom_boxplot() +
      # facet_grid(.~supp)+
      facet_grid(.~supp, labeller = as_labeller(
            c("OJ" = "Orange juice", 
              "VC" = "Vitamin C"))) +
      labs(title = "Tooth growth of 60 guinea pigs by supplement type based on dosage",
           x = "Dose in milligrams/day", 
           y = "Tooth Lengh") +
      scale_fill_discrete(name = "Dosage of\nvitamin C\nin mg/day")

ggplot(ToothGrowth, aes(supp, len, fill=supp)) +
    geom_boxplot() + theme_bw() + 
    labs(title = "Tooth rowth of 60 guinea pigs based on supplement type only",
          x = "Supplement", 
          y = "Length", 
          color = "Supplement") + 
    scale_fill_brewer(palette = "Dark2")

```

***

#### 3. Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. 

The hypothesis tests will be performed using th P value approach, if there is a significance difference with different dosage and supplement type. We want a 95% chance the data is significant and we set the critical value to be 5% (p = 0.05). If the P value is smaller than 0.05) then it is unlikely and if the P value is larger than 0.05) then it is likely that the different supplement and dose has impact on the tooth growth of the guinea pigs. 

Based on the explotary data analysis and the summary of the ToothGrowth data performed above we know that there are a total of 60 guinea pigs: 30 are fed with OJ with different dosage and another 30 are fed with VC with different dosage.


Test 1: T Test based on supplement type

```{r TestSupplement}
test1 <- t.test(len~supp, data = ToothGrowth, paired = FALSE, var.equal = TRUE)
test1
```


```{r oj_vcData}
## Dataset based on OJ Supplement
ojData <- subset(ToothGrowth, supp %in% c("OJ"))
ojData

## Dataset based on VC Supplement
vcData <- subset(ToothGrowth, supp %in% c("VC"))
vcData
```

```{r TestDose}
##Comparing tooth growth base on dose 0.5 vs 1
ojTest2 <- t.test(len~dose, data = subset(ojData, dose %in% c(.5, 1)), paired = TRUE, var.equal = TRUE)
ojTest2

vcTest2 <- t.test(len~dose, data = subset(vcData, dose %in% c(.5, 1)), paired = TRUE, var.equal = TRUE)
vcTest2
ojTest2$p.value
ojTest2$conf.int

```