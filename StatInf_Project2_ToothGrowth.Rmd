---
title: "StatInf_Assignment2_ToothGrowth"
author: "Willianto Asalim"
date: "17/05/2020"
output:
  pdf_document: default
  html_document: default
---


##  Statistical Inference Proj 2: Basic Inferential Data Analysis

<br />


#### The Effect Of Vitamin C On Tooth Growth In Guinea Pigs
***

<br />


### Sypnosis

The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).

Info on ToothGrowth dataset can be found at the following link: [rdocumentation website](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/ToothGrowth) <- click here

```{r LoadPackages, echo=FALSE}
library(knitr) ##Load Knitr package
library(ggplot2) ##Plotting and data
library(pander) ##Load package for tidy T test result
```

```{r setoptions, echo=FALSE}
## Setting Global Option where echo = true so that someone will be able to read the code and results.
knitr::opts_chunk$set(echo = TRUE, results = "hold", tidy = TRUE)
```

<br />

### 1. Load the ToothGrowth data and perform some basic exploratory data analyses
***

```{r LoadToothGrowth_EDA}
library(datasets) ##Load R Builtin Data sets
data("ToothGrowth") ##Load ToothGrowth Datasets
```

```{r CheckToothGrowthData}
dim(ToothGrowth) ##No. observations and variables
names(ToothGrowth) ##Variables names
kable(head(ToothGrowth)) ##First 6 rows of data
```

<br />

```{r, ToothGrowthPlot}
library(gridExtra) ##Provide side by side plotting
edaPlot <- ggplot(ToothGrowth, aes(factor(dose), len, color = supp))  ##ggplot basic info
p1 <- edaPlot + geom_point(size = 2) + theme_bw() + 
        labs(x = "Dose in milligrams", y = "Length", color = "Supp") +
        scale_color_brewer(palette = "Dark2")

p2 <- edaPlot + geom_boxplot() +
      # facet_grid(.~supp)+
      facet_grid(.~supp, labeller = as_labeller(
            c("OJ" = "Orange juice", "VC" = "Vitamin C"))) +
      labs(x = "Dose in milligrams", y = "Length") +
      scale_fill_discrete(name = "Dosage of\nvitamin C\nin mg/day")

## Side by side plotting
grid.arrange(p1, p2, ncol=2, 
             top = "Tooth Growth of Guinea Pigs - Different Dose Intake of OJ and VC")

```

<br />

##### The ToothGrowth Dataset contains `r nrow(ToothGrowth)` observations and `r length(ToothGrowth)` variables: `r names(ToothGrowth)`.

<br />

### 2. Provide a basic summary of the data.
***
```{r ToothGrowthSummary}
kable(summary(ToothGrowth))
```

### 3. Use conf. intervals or hypothesis tests to compare tooth growth by supp & dose
***
Based on the exploratory data analysis and the summary of the ToothGrowth data performed above we know that there are a total of 60 guinea pigs: 30 are fed with OJ with 3 different dosages and another 30 are fed with VC with 3 different dosages.

The hypothesis tests will be performed using th P value approach, if there is a significance difference with different dosage and supplement type. There are different tests we can carry out in the ToothGrowth dataset and in this instance we will be conducting 4 tests.

<br />

- Test based on 2 different supplements ie OJ vs VC  
- Test based on 3 different dosages in the same supplement. ie half dose vs one dose vs two dose in OJ supplement vice versa.

<br />

3 different dosages data created (Result refer to the appendix)
```{r DoseData}
## Dataset based on 0.5 dose
lowDose <- subset(ToothGrowth, dose %in% c("0.5"))

## Dataset based on 1.0 dose
midDose <- subset(ToothGrowth, dose %in% c("1"))

## Dataset based on 2.0 dose
highDose <- subset(ToothGrowth, dose %in% c("2"))
```

<br />

T Test based on supplement type (Result refer to Appendix)
```{r TestSupplement}
## T Test on different supplements OJ vs VC
test1 <- t.test(len~supp, data = ToothGrowth, paired = FALSE, var.equal = TRUE)
```



<br />

T Test based on different dose of OJ vs VC (Result refer to Appendix)
```{r TestDose, fig.height= 3, fig.width=3}
##Comparing 0.5 dose tooth growth based supplements 
lowDoseTest <- t.test(len~supp, data=subset(lowDose, supp%in%c("OJ", "VC")), 
                      paired=F, var.equal=T) 


##Comparing 1.0 dose tooth growth based supplements
midDoseTest <- t.test(len~supp, data=subset(midDose, supp%in%c("OJ", "VC")), 
                      paired=F, var.equal=T)

##Comparing 2.0 dose tooth growth based supplements
highDoseTest <- t.test(len~supp, data=subset(highDose, supp%in%c("OJ", "VC")), 
                       paired=F, var.equal=T)
```

<br />

### 4. State your conclusions and the assumptions needed for your conclusions.
***
We would like more than 95% confidence interval because anything less than that is not significance difference for scientific studies and therefore the P value must be less than 5% or < 0.05. If the P value is smaller than 0.05 this means that it is likely that the supplement or dose has impact on the tooth growth of the guinea pigs. If the P value is larger than 0.05 then it is unlikely that the supplement or dose has impact on the tooth growth of the guinea pigs. 

Based on the T test conducted above, the P value of guinea pigs consuming OJ or VC is `r test1$p.value`. The P value is more than 0.05 which means there is no significance difference whether the guinea pigs consume OJ or VC to enhance the tooth growth. 

But for scientific research purpose we would like to see whether the different dosage of OJ or VC intake has any impact on the tooth growth of the guinea pigs. Observing the T tests conducted above, when the dose are 0.5 and 1.0 the P Values are `r lowDoseTest$p.value` and `r format(midDoseTest$p.value, scientific=F)` respectively. The P values are less than 0.05 which means that there is a significance difference. Guinea pigs that consumed 0.5 and 1.0 dose of OJ will have higher tooth growth compared to the guinea pigs that consumed 0.5 and 1.0 dose of VC.

Whereas the dose of 2.0, the P value is `r highDoseTest$p.value`. The P value is more than 0.05 which means there is no significance difference in tooth growth whether the guinea pigs consumed 2.0 dose of OJ or VC.


<br />

### 5. Appendix
***

##### T Test Results
T Test based on supplements - OJ vs VC
`r pander(test1)`

T Test based on Dose 0.5 of OJ vs VC
`r pander(lowDoseTest)`

T Test based on Dose 1.0 of OJ vs VC
`r pander(midDoseTest)`

T Test based on Dose 2.0 of OJ vs VC
`r pander(highDoseTest)`

***
##### 3 different dosages data of both OJ and VC

0.5 Low Dose Data
`r kable(lowDose)`

1.0 Mid Dose Data
`r kable(midDose)`

2.0 High Dose Data
`r kable(highDose)`

***

##### The platform specification used:
Spec    | Description
------- | -----------------------
OS      | Windows 10 Pro - 64 bit
CPU     | AMD Ryzen 5 - 3400G
RAM     | 16GB DDR4 3000MHz
Storage | 500GB SSD - M.2 NVMe (PCIe) 
Tool    | RStudio


